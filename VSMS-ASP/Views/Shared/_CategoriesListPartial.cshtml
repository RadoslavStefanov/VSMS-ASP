@model IEnumerable<CategoryViewModel>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="~/css/UserListTableStyle.css">
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>


<table>
  <tr>
    <th>Кат.Номер</th>
    <th>Категория</th>
    <th>Управление</th>
  </tr>
  @foreach(var c in Model)
  {
      <tr>
		 <td id = "identificator">@c.Id</td>
         <td>@c.Name</td>
         <td>
            <a href="#myModal" class="trigger-btn delete-btn" data-toggle="modal">
			<i class="fa fa-trash" aria-hidden="true"></i>
			</a>
			<a class="edit-btn" href="#">
			<i class="fa fa-pencil" aria-hidden="true"></i>
			</a>
         </td>
      </tr>
  }

  <!-- Modal HTML -->
<div id="myModal" class="modal fade">
	<div class="modal-dialog modal-confirm">
		<div class="modal-content">
			<div class="modal-header flex-column">
				<div class="icon-box">
					<i class="material-icons">&#xE5CD;</i>
				</div>						
				<h4 class="modal-title w-100">Сигурни ли сте?</h4>	
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
			</div>
			<div class="modal-body">
				<p>Наистина ли искате да изтриете тази категория? Този процес не е обратим!</p>
			</div>
			<div class="modal-footer justify-content-center">
				<button type="button" class="btn btn-secondary" data-dismiss="modal">Отказ</button>
				<button type="button" class="btn btn-danger"><a id="delete" href="#">Изтрий</a></button>
			</div>
		</div>
	</div>
</div>  
</table>

<script>
	let delIcons = document.getElementsByClassName("delete-btn");
	for(let i = 0;i<delIcons.length;i++)
	{delIcons[i].addEventListener('click',addHref)}

	let editIcons = document.getElementsByClassName("edit-btn");
	for(let i = 0;i<editIcons.length;i++)
	{editIcons[i].addEventListener('click',addEditRef)}

	function addEditRef(e)
	{
		let modalDelBTN = document.getElementById("delete");
		let userMail = e.target.parentNode.parentNode.parentNode.querySelector("td:nth-of-type(2)").innerText;
		window.location.replace("/Users/Edit/?arg="+userMail);
	}

	function addHref(e)
	{
		let modalDelBTN = document.getElementById("delete");
		let userMail = e.target.parentNode.parentNode.parentNode.querySelector("td:nth-of-type(2)").innerText;
		modalDelBTN.setAttribute("href", "/Categories/Delete/?arg="+userMail);
	}
</script>